---
title: "PT_Teacher_simulator"
author: "Kartikeya Pandey"
date: "22/10/2020"
output: html_document
---

##Introduction
#In this assignement, the aim is to analyze the data in the training set and classify it into five categories. The dataset consists  of biometrics generated by fitbit( #wearable fitness tracking device).


```{r}
#install.packages("caret")
#install.packages("ggplot2")
#install.packages("rpart")
#install.packages("randomForest")
```
#Importing Libraries
#caret library which contains the classification and regression Trees are imported.
#readr library is used for reading .csv files 
```{r}
library(caret)
library(readr)
library(rpart)
library(randomForest)
```

## Getting the Data

```{r}
#Importing data
###Reading it
pmlpml_training <- read_csv("pml-training.csv")
summary(pmlpml_training)
#importing test dataset
pmlpml_testing <- read_csv("pml-testing.csv")
summary(pmlpml_testing)
```

##Exploratory Data Analysis

```{r}
#Exploratory Data Analysis follows next
###getting type of data in each column
str(pmlpml_training)

###getting row and column countt
dim(pmlpml_training)

###counting for the final result
table(pmlpml_training$classe)

```
#Data wrangling
#Dealing with various  missing values


```{r}
#Exploratory Data Analysis follows next
###getting type of data in each column

values_na = sapply(1:dim(pmlpml_training)[2],function(x)sum(is.na(pmlpml_training[,x])))
List_nana = which(values_na>0)
colnames(pmlpml_training[,c(1:7)])

```
###removing all null values from data

```{r}
pmlpml_training = pmlpml_training[,-List_nana]
pmlpml_training = pmlpml_training[,-c(1:7)]
pmlpml_training$classe = factor(pmlpml_training$classe)
###removing the null values from the test set
pmlpml_testing = pmlpml_testing[,-List_nana]
pmlpml_testing = pmlpml_testing[,-c(1:7)]
```
#Building the Model
#Decision Tree

```{r}
#Exploratory Data Analysis follows next
###for obtaining the type of each column

Classifier = rpart(formula = classe~.,data=pmlpml_training)
y_pred = predict(Classifier,pmlpml_testing)
print(y_pred)

y_pred_actual = predict(Classifier,pmlpml_testing,type="class")
print(y_pred_actual)


```
#Random Forest

```{r}
#Exploratory Data Analysis
###for obtaining the type of each column

rfclassifier = randomForest(formula = classe~.,data=pmlpml_training, ntree = 10)
y_pred_rf = predict(rfclassifier,pmlpml_testing)
print(y_pred_rf)
```



